function generateId() {
  return 'id-' + Math.random().toString(36).slice(2, 10);
}

function fixIdInCookie() {
  const cookie = document.cookie
    .split('; ')
    .find(row => row.startsWith('localaccount='))
    ?.split('=')[1];

  if (!cookie) {
    console.warn('No localaccount cookie found.');
    return;
  }

  let account;
  try {
    account = JSON.parse(decodeURIComponent(cookie));
  } catch (e) {
    console.error('Cookie is corrupted:', e);
    return;
  }

  if (!account.id) {
    account.id = generateId();
    const expires = new Date(Date.now() + 365 * 864e5).toUTCString();
    document.cookie = `localaccount=${encodeURIComponent(JSON.stringify(account))}; expires=${expires}; path=/`;
    console.log('ID fixed and updated:', account.id);
  } else {
    console.log('ID already exists:', account.id);
  }
}

fixIdInCookie();
